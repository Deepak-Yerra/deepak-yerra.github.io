<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy Birthday Shiny üåô</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Sacramento&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
  font-family:Poppins,sans-serif;
  background:#020309;
  color:#e4e9ff;
  overflow-x:hidden; /* allow vertical scroll if needed */
}

/* ENVELOPE SCREEN */
#envelope-screen{
  position:fixed;inset:0;
  display:flex;justify-content:center;align-items:center;
  flex-direction:column;
  text-align:center;
  background:radial-gradient(circle at top,#121831,#020309);
  z-index:9999;
}

.envelope{
  width:240px;
  height:160px;
  position:relative;
  cursor:pointer;
  transition:transform .4s;
}
.envelope:hover{transform:scale(1.04);}

.envelope .back{
  position:absolute;
  width:100%;height:100%;
  background:#d4d0c7;
  border:2px solid #777;
  border-radius:6px;
}
.envelope .flap{
  position:absolute;
  top:0;
  width:100%;height:100%;
  background:#c9c5bc;
  border-top-left-radius:6px;
  border-top-right-radius:6px;
  clip-path:polygon(0 0,100% 0,50% 52%);
  transform-origin:top;
  transition:transform 1.1s ease;
}
.envelope.open .flap{ transform:rotateX(-180deg); }

#letter{
  position:absolute;
  top:20px;
  left:50%;
  transform:translateX(-50%) translateY(40px) scale(0.7) rotateX(90deg);
  width:200px;
  height:120px;
  background:white;
  border-radius:6px;
  opacity:0;
  transition:1s ease;
  padding:14px;
  font-family:"Poppins";
  text-align:center;
}
#letter.show{
  opacity:1;
  transform:translateX(-50%) translateY(-55px) scale(1) rotateX(0deg);
}
#letter h3{
  font-size:1rem;
  color:#222;
  margin-top:28px;
  font-weight:600;
}

/* flower-giving animation under envelope */
#flower-anim{
  margin-top:24px;
  opacity:0;
  transform:translateY(10px);
  transition:opacity 0.8s ease, transform 0.8s ease;
}
#flower-anim.show{
  opacity:1;
  transform:translateY(0);
}
.flower-give{
  /* slower, softer motion */
  animation:flowerPulse 3.6s ease-in-out infinite;
}
@keyframes flowerPulse{
  0%{transform:scale(0.98);}
  50%{transform:scale(1.02);}
  100%{transform:scale(0.98);}
}

/* SCENES (full-screen stack) */
.scene{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:1.7rem;
  opacity:0;
  pointer-events:none;
  transition:opacity .7s ease;
}
.scene.active{
  opacity:1;
  pointer-events:auto;
}

.card{
  width:100%;max-width:430px;
  background:rgba(4,8,22,.86);
  border-radius:1.3rem;
  padding:2.3rem;
  text-align:center;
  transform:translateY(40px);
  opacity:0;
  transition:1s;
  box-shadow:0 0 22px rgba(0,0,0,.7);
  max-height:calc(100vh - 3rem);   /* allow scroll inside card */
  overflow-y:auto;
}
.card.show{opacity:1;transform:translateY(0);}
.title{font-family:"Sacramento";font-size:2.7rem;margin-bottom:.5rem;}
.subtitle{opacity:.9;font-size:.94rem;white-space:pre-line;margin-bottom:1.1rem;}

/* Couple + beach */
#couple-wrapper{
  position:relative;
  display:flex;
  justify-content:center;
  margin-top:12px;
}
#couple{
  width:270px;
  opacity:1;
  filter:drop-shadow(0 0 14px rgba(255,255,255,0.9));
}

/* animated waves group inside SVG */
#couple-waves{
  animation:wavesMove 6s ease-in-out infinite;
  transform-box:fill-box;
  transform-origin:center;
}
@keyframes wavesMove{
  0%  {transform:translateX(0) translateY(0);}
  50% {transform:translateX(-20px) translateY(3px);}
  100%{transform:translateX(0) translateY(0);}
}

/* small stars near couple */
.couple-star{
  position:absolute;
  width:4px;height:4px;
  background:white;
  border-radius:50%;
  opacity:.8;
  animation:starTwinkle 2s infinite alternate;
  filter:drop-shadow(0 0 6px rgba(255,255,255,0.9));
}
@keyframes starTwinkle{
  0%{opacity:.2;transform:scale(.6);}
  100%{opacity:1;transform:scale(1);}
}

/* background twinkle stars */
.twinkle{
  position:fixed;width:2px;height:2px;border-radius:50%;background:white;
  animation:twinkle 2.4s infinite alternate;
  opacity:0;z-index:-2;
}
@keyframes twinkle{from{opacity:.2;}to{opacity:1;}}

/* Rain */
.rain-drop{
  position:fixed;
  width:2px;height:18px;
  background:linear-gradient(to bottom,rgba(255,255,255,0.5),rgba(255,255,255,0));
  border-radius:1px;
  filter:blur(0.2px);
  pointer-events:none;
  animation:rainFall 1s linear forwards;
  z-index:-1;
}
@keyframes rainFall{
  0%{transform:translateY(-10vh) translateX(0) rotate(-10deg);opacity:.7;}
  100%{transform:translateY(120vh) translateX(-5vw) rotate(-10deg);opacity:0;}
}

/* Blue flash */
#sky-flash{
  position:fixed;inset:0;
  background:rgba(120,170,255,0.22);
  pointer-events:none;
  opacity:0;
  transition:.6s;
  z-index:-1;
}

/* Petals */
.petal{
  position:fixed;width:14px;height:14px;
  background:radial-gradient(circle,#ff6b9f,#c22756);
  border-radius:60% 40% 70% 30%;
  opacity:.85;
  animation:petalFall 6s linear forwards;
  z-index:-1;
}
@keyframes petalFall{
  0%{transform:translateY(-10vh) rotate(0deg);opacity:1;}
  50%{transform:translateY(50vh) rotate(120deg);opacity:.9;}
  100%{transform:translateY(100vh) rotate(260deg);opacity:0;}
}

/* Shooting star */
.shooting-star{
  position:fixed;
  width:2px;
  height:80px;
  background:linear-gradient(180deg,#ffffff,rgba(255,255,255,0));
  filter:drop-shadow(0 0 4px white);
  transform:rotate(-45deg);
  opacity:0;
  z-index:5;
  animation:starShoot 1.3s ease-out forwards;
}
@keyframes starShoot{
  0%{opacity:1;transform:translate(-10vw,-10vh) rotate(-45deg) scale(1);}
  70%{opacity:1;}
  100%{opacity:0;transform:translate(50vw,50vh) rotate(-45deg) scale(0.7);}
}

/* Realistic fireworks */
.firework-burst{
  position:fixed;
  width:4px;height:4px;
  pointer-events:none;
  z-index:12;
}
.firework-particle{
  position:absolute;
  width:4px;height:4px;
  border-radius:50%;
  animation:fireworkParticle 1.1s ease-out forwards;
}
@keyframes fireworkParticle{
  0%{transform:translate(0,0) scale(1);opacity:1;}
  100%{transform:translate(var(--dx),var(--dy)) scale(var(--scaleEnd));opacity:0;}
}

/* Photo */
.photo-box{
  border-radius:1rem;
  overflow:hidden;
  box-shadow:0 0 20px rgba(0,0,0,.7);
}
.photo-box img{width:100%;display:block;}

/* Boy holding cake SVG */
.cake-scene svg{
  width:min(260px,80vw);
  animation:floatCake 4s infinite alternate;
}
@keyframes floatCake{from{transform:translateY(0);}to{transform:translateY(-6px);}}

/* Flame */
.candle-flame{
  animation:flameReal 0.8s infinite alternate;
  transform-origin:center bottom;
}
@keyframes flameReal{
  0%{transform:scale(1) translateY(0);opacity:.8;}
  50%{transform:scale(1.2,1.4) translateY(-2px);opacity:1;}
  100%{transform:scale(0.9,1.1) translateY(1px);opacity:.7;}
}
.candle-flame.off{opacity:0;animation:none;}
.candle-flame.dramatic{animation:dramaticFlicker .18s linear infinite;}
@keyframes dramaticFlicker{
  0%{opacity:1;transform:scale(1);}
  25%{opacity:.2;transform:scale(.6);}
  50%{opacity:.9;transform:scale(1.2);}
  75%{opacity:.3;transform:scale(.7);}
  100%{opacity:1;transform:scale(1);}
}

/* cake cut line */
#cutLine{
  stroke-dasharray:40;
  stroke-dashoffset:40;
}
#cutLine.cut{
  stroke-dashoffset:0;
  transition:stroke-dashoffset .7s ease-out;
}

/* "hand motion" from girl to cake when cutting */
#cutHand{
  opacity:0;
}
#cutHand.show{
  opacity:1;
  transition:opacity .2s ease-out;
}

.final-glow{
  margin-top:1.3rem;font-size:1rem;font-style:italic;
  color:#dfe6ff;
  text-shadow:0 0 6px rgba(255,255,255,.6),0 0 14px rgba(170,200,255,.4);
  animation:glowPulse 2.6s infinite alternate;
}
@keyframes glowPulse{from{opacity:.8;}to{opacity:1;}}

/* moon + glow */
.moon{
  position:fixed;top:8%;right:10%;
  width:60px;height:60px;border-radius:50%;
  background:radial-gradient(circle at 30% 30%,#ffffff,#d2e0ff 55%,#8d9cc4 100%);
  box-shadow:0 0 18px rgba(255,255,255,0.6);
  animation:moonFloat 6s ease-in-out infinite alternate;
  z-index:-1;
}
@keyframes moonFloat{from{transform:translateY(0);}to{transform:translateY(10px);}}

/* glow halo */
.moon-glow{
  position:fixed;
  top:8%;right:10%;
  width:160px;height:160px;
  transform:translate(25px,25px);
  background:radial-gradient(circle,
    rgba(255,255,255,.35),
    rgba(180,200,255,.12),
    transparent 70%);
  border-radius:50%;
  animation:moonPulse 5s infinite alternate;
  pointer-events:none;
  z-index:-2;
}
@keyframes moonPulse{
  0%{opacity:.3;transform:scale(0.9) translate(25px,25px);}
  100%{opacity:.7;transform:scale(1.05) translate(25px,25px);}
}

/* Teddy + Balloon Floating */
.teddyFloat{
  animation:floatTeddy 3.2s infinite ease-in-out;
}
@keyframes floatTeddy{
  0%{ transform:translateY(0); }
  50%{ transform:translateY(-6px); }
  100%{ transform:translateY(0); }
}

/* Wind sway */
.swayWind{
  animation:floatTeddy 3.2s infinite ease-in-out, swayWind 3.6s infinite ease-in-out;
  transform-origin:center top;
}
@keyframes swayWind{
  0%{ transform:rotate(0deg); }
  50%{ transform:rotate(3deg); }
  100%{ transform:rotate(0deg); }
}

/* reactive glow base */
.reactiveGlow{
  transition: filter 0.18s linear;
}

/* Sparkles around title icon (blue fade) */
.sparkle{
  position:absolute;
  width:6px;height:6px;
  background:white;
  border-radius:50%;
  opacity:0;
  filter:drop-shadow(0 0 6px white);
  animation:sparkleBlue 1.3s ease-out forwards;
}
@keyframes sparkleBlue{
  0%{
    transform:scale(0.4);
    opacity:0;
    background:white;
    filter:drop-shadow(0 0 4px white);
  }
  45%{
    transform:scale(1.4);
    opacity:1;
    background:#d9e6ff;
    filter:drop-shadow(0 0 8px rgba(140,180,255,1));
  }
  100%{
    transform:scale(0.7);
    opacity:0;
    background:#7da8ff;
    filter:drop-shadow(0 0 4px rgba(120,160,255,0.7));
  }
}

/* small hints */
.hint{
  margin-top:1.4rem;
  font-size:0.8rem;
  opacity:0.75;
}
</style>
</head>

<body>

<!-- ENVELOPE SCREEN -->
<div id="envelope-screen">
  <div class="envelope" id="envelope">
    <div class="back"></div>
    <div class="flap"></div>
    <div id="letter">
      <h3>For the girl who changed my world</h3>
    </div>
  </div>

  <!-- boy giving flowers, girl taking (faces without ears) -->
  <div id="flower-anim">
    <svg class="flower-give" width="210" height="80" viewBox="0 0 210 80">
      <rect width="210" height="80" fill="transparent"/>

      <!-- Boy (left) -->
      <g>
        <!-- head -->
        <circle cx="60" cy="26" r="8" fill="none" stroke="#ffffff" stroke-width="1.5"/>
        <!-- eyes -->
        <circle cx="57"  cy="25" r="0.9" fill="#ffffff"/>
        <circle cx="63"  cy="25" r="0.9" fill="#ffffff"/>
        <!-- nose -->
        <line x1="60" y1="26.5" x2="60" y2="28" stroke="#ffffff" stroke-width="0.7"/>
        <!-- mouth -->
        <path d="M57.5 29 Q60 30.2 62.5 29"
              fill="none" stroke="#ffffff" stroke-width="0.7" stroke-linecap="round"/>

        <line x1="60" y1="34" x2="60" y2="50" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round"/>
        <path d="M52 50 L68 50 L68 64 L52 64 Z"
              fill="none" stroke="#ffffff" stroke-width="1.6"/>
        <line x1="56" y1="64" x2="54" y2="76" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round"/>
        <line x1="64" y1="64" x2="68" y2="76" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round"/>
        <path d="M60 40 Q78 44 90 42"
              fill="none" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round"/>
      </g>

      <!-- Girl (right) -->
      <g>
        <!-- head -->
        <circle cx="150" cy="26" r="8" fill="none" stroke="#ffffff" stroke-width="1.5"/>
        <!-- eyes -->
        <circle cx="147" cy="25" r="0.9" fill="#ffffff"/>
        <circle cx="153" cy="25" r="0.9" fill="#ffffff"/>
        <!-- nose -->
        <line x1="150" y1="26.5" x2="150" y2="28" stroke="#ffffff" stroke-width="0.7"/>
        <!-- smile -->
        <path d="M147.5 29 Q150 30.2 152.5 29"
              fill="none" stroke="#ffffff" stroke-width="0.7" stroke-linecap="round"/>

        <line x1="150" y1="34" x2="150" y2="50" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round"/>
        <path d="M140 50 L160 50 L150 68 Z"
              fill="none" stroke="#ffffff" stroke-width="1.6"/>
        <line x1="146" y1="68" x2="146" y2="76" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round"/>
        <line x1="154" y1="68" x2="154" y2="76" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round"/>
        <path d="M150 42 Q132 44 120 42"
              fill="none" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round"/>
      </g>

      <!-- Flower between hands -->
      <g>
        <line x1="105" y1="30" x2="105" y2="46"
              stroke="#ffffff" stroke-width="1.4"/>
        <circle cx="105" cy="28" r="3"
                fill="none" stroke="#ffffff" stroke-width="1.4"/>
        <circle cx="101.5" cy="28" r="1.5" fill="#ffffff"/>
        <circle cx="108.5" cy="28" r="1.5" fill="#ffffff"/>
        <circle cx="105" cy="24.5" r="1.5" fill="#ffffff"/>
        <circle cx="105" cy="31.5" r="1.5" fill="#ffffff"/>
        <path d="M103 38 Q99 40 100 44" fill="none" stroke="#ffffff" stroke-width="1.2"/>
      </g>
    </svg>
  </div>

  <p style="color:#dcdfff;margin-top:10px;opacity:.8;font-size:.9rem;">
    Tap to open üíå
  </p>
</div>

<!-- MAIN CONTENT -->
<div id="main-content" style="display:none;">
  <div class="moon"></div>
  <div class="moon-glow"></div>

  <audio id="bg-music" loop>
    <source src="song.mp3" type="audio/mpeg">
  </audio>

  <!-- SCENE 1 -->
  <section class="scene" id="scene1">
    <div class="card reveal">
      <h1 class="title" style="display:flex;justify-content:center;align-items:center;gap:18px;">
        Happy Birthday Shiny

        <!-- TEDDY SKETCH HOLDING BALLOONS (with face) -->
        <svg id="teddyNav" width="120" height="120" viewBox="0 0 140 200"
             class="teddyFloat swayWind" style="cursor:pointer;">

          <!-- Balloon cluster with reactive glow -->
          <g id="balloonGlow" class="reactiveGlow">
            <circle cx="40" cy="34" r="22" fill="none" stroke="#cfdff9" stroke-width="2.4"/>
            <circle cx="68" cy="26" r="24" fill="none" stroke="#d7ecff" stroke-width="2.4"/>
            <circle cx="96" cy="36" r="22" fill="none" stroke="#f2dcc2" stroke-width="2.4"/>
            <circle cx="30" cy="56" r="18" fill="none" stroke="#d7ecff" stroke-width="2.1"/>
            <circle cx="60" cy="54" r="20" fill="none" stroke="#f2dcc2" stroke-width="2.1"/>
            <circle cx="92" cy="56" r="18" fill="none" stroke="#cfdff9" stroke-width="2.1"/>
          </g>

          <!-- Strings -->
          <line x1="52" y1="68" x2="60" y2="116" stroke="#ffffff" stroke-width="1.9" />
          <line x1="64" y1="68" x2="60" y2="116" stroke="#ffffff" stroke-width="1.7" />
          <line x1="76" y1="68" x2="60" y2="116" stroke="#ffffff" stroke-width="1.7" />

          <!-- Teddy head + ears -->
          <circle cx="60" cy="132" r="17" fill="none" stroke="#ffffff" stroke-width="2.4"/>
          <circle cx="48" cy="122" r="7" fill="none" stroke="#ffffff" stroke-width="2.2"/>
          <circle cx="72" cy="122" r="7" fill="none" stroke="#ffffff" stroke-width="2.2"/>

          <!-- Teddy face -->
          <!-- eyes -->
          <circle cx="55" cy="130" r="2" fill="#ffffff"/>
          <circle cx="65" cy="130" r="2" fill="#ffffff"/>
          <!-- nose -->
          <circle cx="60" cy="134" r="1.7" fill="#ffffff"/>
          <!-- mouth curve -->
          <path d="M55 138 Q60 141 65 138"
                fill="none" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"/>

          <!-- muzzle outline -->
          <circle cx="60" cy="140" r="4" fill="none" stroke="#ffffff" stroke-width="1.6"/>

          <!-- body -->
          <ellipse cx="60" cy="158" rx="16" ry="20"
                   fill="none" stroke="#ffffff" stroke-width="2.4"/>

          <!-- arms & heart -->
          <path d="M60 146 Q72 140 78 128"
                fill="none" stroke="#ffffff" stroke-width="2.6"/>
          <circle cx="60" cy="116" r="4.5" fill="#ffffff"/>

          <!-- legs -->
          <path d="M52 146 Q44 154 46 166"
                fill="none" stroke="#ffffff" stroke-width="2.4"/>
          <path d="M56 172 Q52 184 54 196"
                fill="none" stroke="#ffffff" stroke-width="2.4" />
          <path d="M64 172 Q70 184 72 196"
                fill="none" stroke="#ffffff" stroke-width="2.4" />
        </svg>
      </h1>

      <div id="couple-wrapper">
        <!-- Couple standing on beach near moving waves (faces, no ears) -->
        <svg id="couple" viewBox="0 0 230 150">
          <rect width="230" height="150" fill="transparent"/>

          <!-- moving waves -->
          <g id="couple-waves">
            <path d="M-40 80 Q-10 72 20 80 T80 80 T140 80 T200 80 T260 80
                     L260 96 L-40 96 Z"
                  fill="rgba(40,90,170,0.85)"/>
            <path d="M-40 86 Q-5 92 30 86 T90 86 T150 86 T210 86 T270 86
                     L270 100 L-40 100 Z"
                  fill="rgba(80,140,210,0.7)"/>
          </g>

          <!-- sand -->
          <path d="M0 100 Q115 92 230 100 L230 150 L0 150 Z"
                fill="rgba(210,190,150,0.55)" stroke="none"/>

          <!-- sand ripples -->
          <path d="M30 112 Q60 116 90 112"
                fill="none" stroke="rgba(230,210,175,0.6)" stroke-width="1"/>
          <path d="M120 116 Q150 120 190 116"
                fill="none" stroke="rgba(230,210,175,0.6)" stroke-width="1"/>

          <!-- Boy (left) with face (no ears) -->
          <g>
            <circle cx="95" cy="72" r="9"
                    fill="none" stroke="#ffffff" stroke-width="1.8"/>
            <!-- eyes -->
            <circle cx="92" cy="71" r="1.1" fill="#ffffff"/>
            <circle cx="98" cy="71" r="1.1" fill="#ffffff"/>
            <!-- nose -->
            <line x1="95" y1="72.5" x2="95" y2="74"
                  stroke="#ffffff" stroke-width="0.7"/>
            <!-- mouth -->
            <path d="M92.5 75 Q95 76.2 97.5 75"
                  fill="none" stroke="#ffffff" stroke-width="0.7" stroke-linecap="round"/>

            <line x1="95" y1="81" x2="95" y2="88"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M88 88 L88 110 L95 116 L102 110 L102 88"
                  fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linejoin="round"/>
            <line x1="92" y1="116" x2="90" y2="134"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <line x1="98" y1="116" x2="102" y2="134"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M88 92 Q80 98 82 108"
                  fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
          </g>

          <!-- Girl (right) with face (no ears) -->
          <g>
            <circle cx="125" cy="72" r="9"
                    fill="none" stroke="#ffffff" stroke-width="1.8"/>
            <!-- eyes -->
            <circle cx="122" cy="71" r="1.1" fill="#ffffff"/>
            <circle cx="128" cy="71" r="1.1" fill="#ffffff"/>
            <!-- nose -->
            <line x1="125" y1="72.5" x2="125" y2="74"
                  stroke="#ffffff" stroke-width="0.7"/>
            <!-- mouth -->
            <path d="M92.5 75 Q95 76.2 97.5 75"
                  fill="none" stroke="#ffffff" stroke-width="0.7" stroke-linecap="round"/>

            <line x1="95" y1="81" x2="95" y2="88"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M88 88 L88 110 L95 116 L102 110 L102 88"
                  fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linejoin="round"/>
            <line x1="92" y1="116" x2="90" y2="134"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <line x1="98" y1="116" x2="102" y2="134"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M88 92 Q80 98 82 108"
                  fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
          </g>

          <!-- Girl (right) with face (no ears) -->
          <g>
            <circle cx="125" cy="72" r="9"
                    fill="none" stroke="#ffffff" stroke-width="1.8"/>
            <!-- eyes -->
            <circle cx="122" cy="71" r="1.1" fill="#ffffff"/>
            <circle cx="128" cy="71" r="1.1" fill="#ffffff"/>
            <!-- nose -->
            <line x1="125" y1="72.5" x2="125" y2="74"
                  stroke="#ffffff" stroke-width="0.7"/>
            <!-- mouth -->
            <path d="M122.5 75 Q125 76.4 127.5 75"
                  fill="none" stroke="#ffffff" stroke-width="0.7" stroke-linecap="round"/>

            <line x1="125" y1="81" x2="125" y2="88"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M118 88 L118 110 L125 116 L132 110 L132 88"
                  fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linejoin="round"/>
            <line x1="122" y1="116" x2="120" y2="134"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <line x1="128" y1="116" x2="132" y2="134"
                  stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M132 92 Q140 98 138 108"
                  fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
          </g>

          <!-- joined hands -->
          <circle cx="110" cy="98" r="3.6"
                  fill="none" stroke="#ffffff" stroke-width="1.5"/>
          <path d="M102 92 Q108 96 110 98"
                fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
          <path d="M118 92 Q112 96 110 98"
                fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round"/>
        </svg>
      </div>

      <p class="subtitle" style="margin-top:1.1rem;">
Some dates fade with time,
but 1 December 2019 stayed ‚Äî
the night a crowd turned into a story,
and my story quietly became you.

Since then, every sea, every sky,
every small, ordinary day
has carried your name somewhere in its light.

I don‚Äôt know what I did to deserve
your laughter, your patience, your heart‚Ä¶
but I know this:
from that first glance till this moment,
loving you has been my favorite decision.
      </p>

      <p class="hint">Tap the teddy to continue ‚ûú</p>
    </div>
  </section>

  <!-- SCENE 2: Photo + deeper poetic wish -->
  <section class="scene" id="scene2">
    <div class="card reveal">
      <div class="photo-box" style="cursor:pointer;">
        <img id="photoNav" src="shiny.jpg" alt="Shiny">
      </div>
      <p class="subtitle" style="margin-top:1.2rem;">On 10 December 2002,
the universe wrote your name
in its softest ink.

There were no drums, no thunder,
just a quiet promise:
that somewhere in the future,
someone would look at you
and finally understand
why wishes and constellations exist.

Years passed.
You grew into kindness,
into patience,
into this rare kind of warmth
that makes other people‚Äôs storms feel smaller.

And then one evening,
you stepped into my ordinary life,
and everything I thought I knew
about ‚Äúhome‚Äù
and ‚Äúforever‚Äù
shifted towards you.

You don‚Äôt just make my days better ‚Äî
you make my life make sense.

My wish for you:
a heart that never doubts its own worth,
eyes that always find the gentle parts of the world,
and a sky that keeps opening new paths
whenever you feel stuck.

Happy Birthday Shiny.
If love had a face in my story,
it would be yours.
      </p>
      <p style="text-align:right;opacity:.85;font-style:italic;margin-top:1rem;">
        With all my love,<br>Deepak
      </p>

      <p class="hint">Tap the picture to continue ‚ûú</p>
    </div>
  </section>

  <!-- SCENE 3: Boy holding cake, girl blows then cuts -->
  <section class="scene" id="scene3">
    <div class="card reveal">
      <h2>Make a wish before you blow</h2>

      <div class="cake-scene" id="cake-area" style="margin-top:1.2rem;cursor:pointer;">
        <svg viewBox="0 0 260 200">
          <rect width="260" height="200" fill="transparent"/>

          <!-- ground shadow -->
          <ellipse cx="130" cy="175" rx="60" ry="8"
                   fill="rgba(5,10,25,0.9)"/>

          <!-- Boy (left) with face holding cake, no ears -->
          <g>
            <circle cx="120" cy="90" r="10"
                    fill="none" stroke="#ffffff" stroke-width="2"/>
            <!-- eyes -->
            <circle cx="117" cy="89" r="1.2" fill="#ffffff"/>
            <circle cx="123" cy="89" r="1.2" fill="#ffffff"/>
            <!-- nose -->
            <line x1="120" y1="90.5" x2="120" y2="92"
                  stroke="#ffffff" stroke-width="0.8"/>
            <!-- mouth -->
            <path d="M117.5 93 Q120 94.4 122.5 93"
                  fill="none" stroke="#ffffff" stroke-width="0.8" stroke-linecap="round"/>

            <line x1="120" y1="100" x2="120" y2="108"
                  stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
            <path d="M105 108 L105 140 L135 140 L135 108"
                  fill="none" stroke="#ffffff" stroke-width="2"/>
            <line x1="112" y1="140" x2="110" y2="170"
                  stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
            <line x1="128" y1="140" x2="132" y2="170"
                  stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>

            <path d="M105 116 Q110 120 114 126"
                  fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
            <path d="M135 116 Q130 120 126 126"
                  fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>

            <!-- cake plate -->
            <ellipse cx="120" cy="128" rx="20" ry="4"
                     fill="none" stroke="#ffffff" stroke-width="2"/>

            <!-- cake body -->
            <rect x="104" y="118" width="32" height="12" rx="3"
                  fill="none" stroke="#ffffff" stroke-width="2"/>

            <!-- candles -->
            <rect x="110" y="110" width="3" height="8"
                  fill="none" stroke="#ffffff" stroke-width="2"/>
            <rect x="120" y="108" width="3" height="10"
                  fill="none" stroke="#ffffff" stroke-width="2"/>
            <rect x="130" y="110" width="3" height="8"
                  fill="none" stroke="#ffffff" stroke-width="2"/>

            <!-- flames -->
            <g class="candle-flame">
              <path d="M111.5 108 Q113.5 103 111.5 99 Q109.5 103 111.5 108"
                    fill="url(#flameGrad1)"/>
            </g>
            <g class="candle-flame">
              <path d="M121.5 106 Q123.5 100 121.5 96 Q119.5 100 121.5 106"
                    fill="url(#flameGrad1)"/>
            </g>
            <g class="candle-flame">
              <path d="M131.5 108 Q133.5 103 131.5 99 Q129.5 103 131.5 108"
                    fill="url(#flameGrad1)"/>
            </g>
          </g>

          <!-- Girl (right) with face, no ears -->
          <g>
            <circle cx="175" cy="92" r="10"
                    fill="none" stroke="#ffffff" stroke-width="2"/>
            <!-- eyes -->
            <circle cx="172" cy="91" r="1.2" fill="#ffffff"/>
            <circle cx="178" cy="91" r="1.2" fill="#ffffff"/>
            <!-- nose -->
            <line x1="175" y1="92.5" x2="175" y2="94"
                  stroke="#ffffff" stroke-width="0.8"/>
            <!-- mouth -->
            <path d="M172.5 95 Q175 96.4 177.5 95"
                  fill="none" stroke="#ffffff" stroke-width="0.8" stroke-linecap="round"/>

            <line x1="175" y1="102" x2="175" y2="110"
                  stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
            <path d="M165 110 L165 140 L185 140 L185 110"
                  fill="none" stroke="#ffffff" stroke-width="2"/>
            <line x1="170" y1="140" x2="168" y2="170"
                  stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
            <line x1="180" y1="140" x2="184" y2="170"
                  stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
            <path d="M185 116 Q192 118 186 126"
                  fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
          </g>

          <!-- breath puff near candles (first tap) -->
          <g id="breathPuff" style="opacity:0;">
            <circle cx="141" cy="104" r="3"
                    fill="none" stroke="#ffffff" stroke-width="1.5"/>
            <circle cx="146" cy="102" r="2"
                    fill="none" stroke="#ffffff" stroke-width="1.2"/>
          </g>

          <!-- cut line on cake (second tap) -->
          <path id="cutLine"
                d="M106 122 L134 126"
                fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>

          <!-- girl's cutting motion line -->
          <path id="cutHand"
                d="M180 118 Q150 120 134 123"
                fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>

          <defs>
            <linearGradient id="flameGrad1" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#fffad5"/>
              <stop offset="40%" stop-color="#ffd27a"/>
              <stop offset="100%" stop-color="#ff9b3d"/>
            </linearGradient>
          </defs>
        </svg>
      </div>

      <p class="final-glow">
        Not every star lives in the sky.<br>
        Some walk the earth ‚Äî quietly lighting lives.
      </p>

      <p class="hint">Tap the cake ‚Äî first to blow, then to cut üéÇ</p>
    </div>
  </section>
</div>

<div id="sky-flash"></div>

<script>
const envelope = document.getElementById("envelope");
const letter = document.getElementById("letter");
const envelopeScreen = document.getElementById("envelope-screen");
const mainContent = document.getElementById("main-content");
const bgMusic = document.getElementById("bg-music");
const flowerAnim = document.getElementById("flower-anim");

const scenes = document.querySelectorAll(".scene");
let currentScene = 0;

function showScene(index){
  scenes.forEach((scene,i)=>{
    const card = scene.querySelector(".card");
    if(i === index){
      scene.classList.add("active");
      if(card) card.classList.add("show");
    }else{
      scene.classList.remove("active");
      if(card) card.classList.remove("show");
    }
  });
}
// Envelope tap
envelope.addEventListener("click", ()=>{
  envelope.classList.add("open");
  setTimeout(()=>letter.classList.add("show"),500);

  if(flowerAnim){
    setTimeout(()=>{
      flowerAnim.classList.add("show");
    },700);
  }

  // petals burst
  for(let i=0;i<24;i++){
    const p=document.createElement("div");
    p.className="petal";
    p.style.left=Math.random()*100+"vw";
    p.style.animationDuration=(5+Math.random()*3)+"s";
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),7000);
  }

  setTimeout(()=>{
    envelopeScreen.style.display="none";
    mainContent.style.display="block";
    fadeInMusic();
    startEffects();
    sparkleOnceTitleIcon();
    currentScene = 0;
    showScene(currentScene);
  },2600);
});

// Music fade
function fadeInMusic(){
  let volume=0;
  bgMusic.volume=0;
  bgMusic.play().catch(()=>{});
  const fade=setInterval(()=>{
    if(volume>=0.7){clearInterval(fade);}
    else{volume+=0.05;bgMusic.volume=volume;}
  },160);
}

// Effects
function startEffects(){
  // background stars
  for(let i=0;i<60;i++){
    const s=document.createElement("div");
    s.className="twinkle";
    s.style.left=Math.random()*100+"vw";
    s.style.top=Math.random()*100+"vh";
    s.style.animationDuration=(1.5+Math.random()*3)+"s";
    document.body.appendChild(s);
  }

  // rain
  setInterval(()=>{
    const drop=document.createElement("div");
    drop.className="rain-drop";
    drop.style.left=Math.random()*100+"vw";
    document.body.appendChild(drop);
    setTimeout(()=>drop.remove(),1500);
  },120);

  // stars near couple
  setInterval(coupleStars,900);

  // shooting star
  setInterval(shootingStar,8000);

  // blue flash
  setInterval(blueFlash,20000);
}

// small stars around couple
function coupleStars(){
  const wrap=document.getElementById("couple-wrapper");
  if(!wrap) return;
  const star=document.createElement("div");
  star.className="couple-star";
  star.style.left=(Math.random()*160+20)+"px";
  star.style.top=(Math.random()*60-10)+"px";
  wrap.appendChild(star);
  setTimeout(()=>star.remove(),2500);
}

// shooting star
function shootingStar(){
  const star=document.createElement("div");
  star.className="shooting-star";
  star.style.left=Math.random()*60+"vw";
  star.style.top=Math.random()*20+"vh";
  document.body.appendChild(star);
  setTimeout(()=>star.remove(),1400);
}

// blue flash
function blueFlash(){
  const flash=document.getElementById("sky-flash");
  flash.style.opacity=1;
  setTimeout(()=>flash.style.opacity=0,600);
}

// fireworks ‚Äì fill whole screen more
function launchFireworks(){
  const colors=["#ffd86b","#ff6b9d","#8b7bff","#6bffde","#ffffff"];
  const bursts = 6; // more bursts
  for(let b=0; b<bursts; b++){
    const burst=document.createElement("div");
    burst.className="firework-burst";
    burst.style.left=(Math.random()*100)+"vw";
    burst.style.top=(Math.random()*80)+"vh";
    document.body.appendChild(burst);

    const particlesCount = 18 + Math.floor(Math.random()*10);
    for(let i=0;i<particlesCount;i++){
      const p=document.createElement("div");
      p.className="firework-particle";
      const angle=Math.random()*Math.PI*2;
      const dist=60+Math.random()*90;  // spread wider
      const dx=Math.cos(angle)*dist;
      const dy=Math.sin(angle)*dist;
      const scaleEnd = 0.3 + Math.random()*0.8;

      p.style.setProperty("--dx",dx+"px");
      p.style.setProperty("--dy",dy+"px");
      p.style.setProperty("--scaleEnd",scaleEnd.toString());
      p.style.background=colors[Math.floor(Math.random()*colors.length)];
      burst.appendChild(p);
    }
    setTimeout(()=>burst.remove(),1300);
  }
}

// CAKE: two-stage tap logic (blow then cut)
let cakeStage = 0; // 0 = ready to blow, 1 = ready to cut, 2 = finished
function handleCakeTap(){
  const flames=document.querySelectorAll(".candle-flame");
  const cutLine=document.getElementById("cutLine");
  const breath=document.getElementById("breathPuff");
  const cutHand=document.getElementById("cutHand");

  if(cakeStage === 0){
    // first tap: blow candles
    if(breath){
      breath.style.opacity="1";
      breath.style.transition="opacity .5s ease-out, transform .5s ease-out";
      breath.style.transform="translateX(6px)";
      setTimeout(()=>{
        breath.style.opacity="0";
      },450);
    }

    flames.forEach(e=>e.classList.add("dramatic"));
    setTimeout(()=>{
      flames.forEach(e=>e.classList.remove("dramatic"));
      flames.forEach(e=>e.classList.add("off"));
      cakeStage = 1; // now ready to cut
    },900);

  }else if(cakeStage === 1){
    // second tap: cut cake + big fireworks
    if(cutHand){
      cutHand.classList.add("show");
      setTimeout(()=>{
        if(cutHand) cutHand.classList.remove("show");
      },400);
    }
    if(cutLine){
      cutLine.classList.add("cut");
    }
    launchFireworks();
    blueFlash();
    shootingStar();
    cakeStage = 2; // done
  }else{
    return;
  }
}

document.getElementById("cake-area").addEventListener("click",handleCakeTap);
document.getElementById("cake-area").addEventListener("touchstart",e=>{e.preventDefault();handleCakeTap();});

/* Sparkles once around title teddy+balloon */
function sparkleOnceTitleIcon(){
  const icon = document.getElementById("teddyNav");
  if(!icon) return;
  const rect = icon.getBoundingClientRect();
  const positions = [
    {x:-6, y:-6},
    {x:30, y:-10},
    {x:10, y:24},
    {x:-10, y:18}
  ];
  positions.forEach((pos,i)=>{
    setTimeout(()=>{
      const sp = document.createElement("div");
      sp.className="sparkle";
      sp.style.left = (rect.left + pos.x) + "px";
      sp.style.top = (rect.top + pos.y) + "px";
      sp.style.position="fixed";
      document.body.appendChild(sp);
      setTimeout(()=>sp.remove(),1400);
    }, i * 200);
  });
}

/* AUDIO REACTIVE: balloon + moon */
let audioCtx;
let analyzer;
let dataArray;
let reactiveStarted = false;

function animateReactiveGlow(){
  if(!analyzer) return;

  analyzer.getByteFrequencyData(dataArray);

  let bass = 0;
  const bassBins = 24;
  for(let i=0;i<bassBins;i++){
    bass += dataArray[i];
  }
  bass /= bassBins;

  let glow = Math.min(1, bass / 180);

  const balloon = document.getElementById("balloonGlow");
  if(balloon){
    balloon.style.filter =
      `drop-shadow(0 0 ${4 + glow*10}px rgba(255,140,200,${0.5 + glow*0.5}))` +
      ` drop-shadow(0 0 ${8 + glow*14}px rgba(120,180,255,${0.5 + glow*0.5}))`;
  }

  const moonGlow = document.querySelector(".moon-glow");
  if(moonGlow){
    const baseScale = 0.9;
    const maxExtra = 0.2;
    const scale = baseScale + glow * maxExtra;
    const opacity = 0.3 + glow * 0.4;

    moonGlow.style.opacity = opacity.toString();
    moonGlow.style.transform = `translate(25px,25px) scale(${scale})`;
  }

  requestAnimationFrame(animateReactiveGlow);
}

bgMusic.addEventListener("play", ()=>{
  if(reactiveStarted) return;
  reactiveStarted = true;

  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  const source = audioCtx.createMediaElementSource(bgMusic);
  analyzer = audioCtx.createAnalyser();
  analyzer.fftSize = 256;
  source.connect(analyzer);
  analyzer.connect(audioCtx.destination);
  dataArray = new Uint8Array(analyzer.frequencyBinCount);

  audioCtx.resume().then(()=>{
    animateReactiveGlow();
  }).catch(()=>{});
});

/* SCENE NAVIGATION: teddy -> scene2, photo -> scene3 */
const teddyNav = document.getElementById("teddyNav");
const photoNav = document.getElementById("photoNav");

if(teddyNav){
  teddyNav.addEventListener("click", ()=>{
    currentScene = 1;
    showScene(currentScene);
  });
}

if(photoNav){
  photoNav.addEventListener("click", ()=>{
    currentScene = 2;
    showScene(currentScene);
  });
}
</script>
</body>
</html>
